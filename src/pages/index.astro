---
import Layout from "../layouts/Layout.astro";
import Card from "../components/Card.astro";
import { CARDS, NAME, ACCENT_COLOR } from "../constants";
---

<script>
   import { DAYS, MONTHS } from "../constants";

   const timeElement = document.getElementById("currentTime");
   const dateElement = document.getElementById("currentDate");

   const formatDigit = (digit: number) => {
      return digit > 9 ? `${digit}` : `0${digit}`;
   };

   const updateDate = () => {
      // Create a new Date object and get the complete Date/Time information
      const completeDate = new Date();

      // Time Variables
      let currentHour = formatDigit(completeDate.getHours());
      let currentMinute = formatDigit(completeDate.getMinutes());

      // Date Variables
      let currentDay = completeDate.getDay();
      let currentDayOfMonthInNumber = completeDate.getDate();
      let currentMonth = completeDate.getMonth();
      let currentYear = completeDate.getFullYear();

      // Update the Time
      timeElement!.textContent = `${
         +currentHour % 12 === 0 ? "12" : +currentHour
      }:${currentMinute} ${+currentHour > 11 ? "PM" : "AM"}`;

      // Update the Date
      dateElement!.textContent = `${DAYS[currentDay]} ${currentDayOfMonthInNumber}, ${MONTHS[currentMonth]} ${currentYear}`;

      // Create a Loop
      setTimeout(() => {
         updateDate();
      }, 1000);
   };
   updateDate();
</script>

<Layout title="Welcome to Astro.">
   <div class="container">
      <header class="header">
         <div>
            <h1>Hello there, <span id="userName">{NAME}</span>.</h1>
            <p>
               Today is <span id="currentDate">Monday 1, January 2000</span>.
            </p>
         </div>
         <p id="currentTime">00:00 PM</p>
      </header>
      <main class="cardContainer">
         {CARDS.map((card) => <Card card={card} />)}
      </main>
   </div>
</Layout>

<style define:vars={{ ACCENT_COLOR }}>
   .container {
      width: 100%;
      max-width: 1280px;
   }

   .header {
      font-weight: 400;

      display: flex;
      justify-content: space-between;
      align-items: center;
   }

   #currentDate {
      color: var(--ACCENT_COLOR);
   }

   #currentTime {
      font-size: 4rem;
      font-weight: 600;
   }

   @media screen and (max-width: 1250px) {
      .header {
         flex-direction: column-reverse;
      }

      #currentTime {
         font-size: 3rem;
         margin-bottom: 1rem;
      }

      #fullDate {
         text-align: center;
      }
   }
</style>
